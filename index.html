<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enrollment Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #2563eb;
            --primary-dark: #1e40af;
            --success: #16a34a;
            --warning: #ea8c00;
            --gray-50: #f9fafb;
            --gray-100: #f3f4f6;
            --gray-300: #d1d5db;
            --gray-500: #6b7280;
            --gray-600: #4b5563;
            --gray-700: #374151;
            --gray-800: #1f2937;
            --gray-900: #111827;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background-color: var(--gray-50);
            color: var(--gray-900);
            transition: background-color 0.3s, color 0.3s;
        }

        body.dark-mode {
            background-color: var(--gray-900);
            color: white;
        }

        /* Header */
        .header {
            background-color: var(--primary);
            color: white;
            padding: 1.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        body.dark-mode .header {
            background-color: #1e3a8a;
        }

        .header-container {
            max-width: 1440px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        .school-logo-container {
            width: 80px;
            height: 80px;
            background: white;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
            position: relative;
            overflow: hidden;
        }

        .school-logo-container::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(135deg, rgba(37, 99, 235, 0.1) 0%, transparent 50%);
            animation: shimmer 3s infinite;
        }

        @keyframes shimmer {
            0% {
                transform: translate(-100%, -100%) rotate(0deg);
            }
            100% {
                transform: translate(100%, 100%) rotate(360deg);
            }
        }

        .school-logo {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            position: relative;
            z-index: 1;
        }

        .header-title {
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .header-title h1 {
            font-size: 1.75rem;
            font-weight: 700;
            letter-spacing: -0.5px;
            line-height: 1.2;
        }

        .header-subtitle {
            font-size: 0.95rem;
            color: rgba(255, 255, 255, 0.9);
            font-weight: 500;
            letter-spacing: 0.5px;
            margin-top: 0.25rem;
        }

        .header-location {
            font-size: 0.85rem;
            color: rgba(255, 255, 255, 0.8);
            display: flex;
            align-items: center;
            gap: 0.4rem;
            margin-top: 0.1rem;
        }

        .location-icon {
            width: 14px;
            height: 14px;
        }

        .theme-toggle {
            background-color: rgba(0, 0, 0, 0.2);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 0.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.3s;
        }

        .theme-toggle:hover {
            background-color: rgba(0, 0, 0, 0.3);
        }

        /* Main Container */
        .container {
            max-width: 1440px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Stepper */
        .stepper {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 3rem;
            overflow-x: auto;
            padding-bottom: 0.5rem;
        }

        .step {
            display: flex;
            align-items: center;
            flex-shrink: 0;
        }

        .step-icon {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            transition: all 0.3s;
            background-color: var(--gray-300);
            color: var(--gray-600);
        }

        body.dark-mode .step-icon {
            background-color: var(--gray-700);
            color: var(--gray-500);
        }

        .step-icon.active {
            background-color: var(--primary);
            color: white;
            box-shadow: 0 10px 15px -3px rgba(37, 99, 235, 0.3);
        }

        .step-icon.completed {
            background-color: var(--success);
            color: white;
        }

        .step-label {
            font-size: 0.75rem;
            font-weight: 500;
            text-align: center;
            width: 60px;
            margin-top: 0.5rem;
            display: none;
        }

        @media (min-width: 768px) {
            .step-label {
                display: block;
            }
        }

        .step-connector {
            height: 4px;
            width: 32px;
            margin: 0 0.25rem;
            margin-top: 24px;
            background-color: var(--gray-300);
            transition: background-color 0.3s;
        }

        .step-connector.completed {
            background-color: var(--success);
        }

        /* Card */
        .card {
            background-color: white;
            border-radius: 0.5rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            padding: 2rem;
            margin-bottom: 2rem;
        }

        body.dark-mode .card {
            background-color: var(--gray-800);
        }

        .card h2 {
            font-size: 1.875rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 1.5rem;
        }

        /* Form */
        .form-group {
            margin-bottom: 1rem;
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
        }

        @media (min-width: 768px) {
            .form-grid-2 {
                grid-template-columns: repeat(2, 1fr);
            }

            .form-grid-3 {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        label {
            display: block;
            font-size: 0.875rem;
            font-weight: 500;
            margin-bottom: 0.5rem;
        }

        .required {
            color: #dc2626;
        }

        input[type="text"],
        input[type="email"],
        input[type="tel"],
        input[type="date"],
        select {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--gray-300);
            border-radius: 0.5rem;
            font-size: 1rem;
            transition: all 0.3s;
            background-color: white;
            color: var(--gray-900);
        }

        body.dark-mode input[type="text"],
        body.dark-mode input[type="email"],
        body.dark-mode input[type="tel"],
        body.dark-mode input[type="date"],
        body.dark-mode select {
            background-color: var(--gray-700);
            border-color: var(--gray-600);
            color: white;
        }

        input[type="text"]:focus,
        input[type="email"]:focus,
        input[type="tel"]:focus,
        input[type="date"]:focus,
        select:focus {
            outline: none;
            ring: 2px;
            ring-color: var(--primary);
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .form-group:last-of-type input,
        .form-grid:last-child .form-group:last-child input,
        .form-grid:last-child .form-group:last-child select {
            border-bottom: 3px solid #4ade80;
        }

        .form-group:last-of-type input:focus,
        .form-grid:last-child .form-group:last-child input:focus,
        .form-grid:last-child .form-group:last-child select:focus {
            border-bottom-color: var(--primary);
        }

        /* File Upload */
        .file-upload {
            border: 2px dashed #93c5fd;
            border-radius: 0.5rem;
            padding: 1.5rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            background-color: white;
        }

        body.dark-mode .file-upload {
            background-color: var(--gray-700);
            border-color: #1e40af;
        }

        .file-upload:hover {
            border-color: var(--primary);
            background-color: #eff6ff;
        }

        body.dark-mode .file-upload:hover {
            background-color: #0c2340;
        }

        .file-upload.uploaded {
            border-color: var(--success);
            background-color: #f0fdf4;
        }

        body.dark-mode .file-upload.uploaded {
            background-color: #052e16;
        }

        .file-upload input {
            display: none;
        }

        .file-upload-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
        }

        .file-upload-icon {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .file-upload.uploaded .file-upload-icon {
            color: var(--success);
        }

        .file-upload-text {
            font-weight: 500;
            font-size: 0.875rem;
        }

        .file-upload-hint {
            font-size: 0.75rem;
            color: var(--gray-500);
            margin-top: 0.25rem;
        }

        /* Alert Box */
        .alert {
            padding: 1rem;
            border-radius: 0.5rem;
            display: flex;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
            font-size: 0.875rem;
        }

        .alert-warning {
            background-color: #fef3c7;
            border: 1px solid #fde047;
            color: #92400e;
        }

        body.dark-mode .alert-warning {
            background-color: #78350f;
            border-color: #b45309;
            color: #fef3c7;
        }

        .alert-success {
            background-color: #dcfce7;
            border: 1px solid #86efac;
            color: #15803d;
        }

        body.dark-mode .alert-success {
            background-color: #064e3b;
            border-color: #10b981;
            color: #dcfce7;
        }

        .alert-icon {
            flex-shrink: 0;
            margin-top: 0.125rem;
        }

        /* Review Section */
        .review-section {
            border-bottom: 1px solid var(--gray-300);
            padding-bottom: 1rem;
            margin-bottom: 1.5rem;
        }

        body.dark-mode .review-section {
            border-bottom-color: var(--gray-600);
        }

        .review-section h3 {
            font-size: 1.125rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 0.75rem;
        }

        .review-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
        }

        @media (min-width: 768px) {
            .review-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        .review-item p:first-child {
            color: var(--gray-500);
            font-size: 0.875rem;
        }

        .review-item p:last-child {
            font-weight: 600;
            margin-top: 0.25rem;
        }

        /* Buttons */
        .button-group {
            display: flex;
            gap: 1rem;
            justify-content: space-between;
            max-width: 512px;
            margin: 0 auto;
        }

        button {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 0.5rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
        }

        .btn-previous {
            background-color: var(--gray-600);
            color: white;
        }

        .btn-previous:hover {
            background-color: var(--gray-700);
        }

        .btn-previous:disabled {
            background-color: var(--gray-300);
            color: var(--gray-500);
            cursor: not-allowed;
        }

        .btn-next {
            background-color: var(--primary);
            color: white;
        }

        .btn-next:hover {
            background-color: var(--primary-dark);
        }

        .btn-submit {
            background-color: var(--success);
            color: white;
        }

        .btn-submit:hover {
            background-color: #15803d;
        }

        .btn-new {
            width: 100%;
            background-color: var(--primary);
            color: white;
            padding: 0.75rem;
            margin-top: 1rem;
        }

        .btn-new:hover {
            background-color: var(--primary-dark);
        }

        /* Progress */
        .progress-text {
            text-align: center;
            margin-top: 1.5rem;
            font-size: 0.875rem;
            color: var(--gray-600);
        }

        body.dark-mode .progress-text {
            color: var(--gray-500);
        }

        /* Completion Screen */
        .completion-screen {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }

        .completion-card {
            background-color: white;
            border-radius: 0.5rem;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            padding: 2rem;
            max-width: 448px;
            text-align: center;
        }

        body.dark-mode .completion-card {
            background-color: var(--gray-800);
        }

        .completion-icon {
            width: 64px;
            height: 64px;
            background-color: var(--success);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1.5rem;
            font-size: 2rem;
        }

        .completion-card h2 {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--success);
            margin-bottom: 0.5rem;
        }

        .completion-card p {
            color: var(--gray-600);
            margin-bottom: 1.5rem;
        }

        body.dark-mode .completion-card p {
            color: var(--gray-400);
        }

        .ref-box {
            background-color: var(--gray-100);
            padding: 1rem;
            border-radius: 0.5rem;
            margin-bottom: 1.5rem;
            text-align: left;
            font-size: 0.875rem;
        }

        body.dark-mode .ref-box {
            background-color: var(--gray-700);
        }

        .ref-box p:first-child {
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .ref-box p:last-child {
            font-weight: 700;
            color: var(--primary);
        }

        /* Info Box */
        .info-box {
            background-color: #eff6ff;
            border: 1px solid #bfdbfe;
            padding: 1rem;
            border-radius: 0.5rem;
            margin-bottom: 1rem;
        }

        body.dark-mode .info-box {
            background-color: #0c2340;
            border-color: #1e40af;
        }

        .info-box p {
            font-size: 0.875rem;
        }

        /* Responsive */
        @media (max-width: 640px) {
            .container {
                padding: 1rem;
            }

            .card {
                padding: 1.5rem;
            }

            .button-group {
                flex-direction: column-reverse;
            }

            button {
                justify-content: center;
                width: 100%;
            }
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <div class="header-container">
            <div class="header-left">
                <div class="school-logo-container">
                    <div class="school-logo"></div>
                    <img src="image.png" alt="school-logo" class="school-logo-img">
                </div>
                <div class="header-title">
                    <h1>Manguisoc National High School</h1>
                    <div class="header-subtitle">Online Enrollment System</div>
                    <div class="header-location">
                        <span>📍</span>
                        <span>Mercedes, Camarines Norte</span>
                    </div>
                </div>
            </div>
            <button class="theme-toggle" id="themeToggle" onclick="toggleTheme()">🌙</button>
        </div>
    </div>

    <!-- Main Container -->
    <div class="container">
        <!-- Stepper -->
        <div class="stepper" id="stepper"></div>

        <!-- Form Card -->
        <div class="card" id="formCard"></div>

        <!-- Navigation -->
        <div class="button-group">
            <button class="btn-previous" id="prevBtn" onclick="handlePrevious()" disabled>← Previous</button>
            <button class="btn-next" id="nextBtn" onclick="handleNext()">Next →</button>
        </div>

        <!-- Progress -->
        <div class="progress-text" id="progressText"></div>
    </div>

    <!-- Completion Screen (Hidden) -->
    <div class="completion-screen hidden" id="completionScreen">
        <div class="completion-card">
            <div class="completion-icon">✓</div>
            <h2>Enrollment Successful!</h2>
            <p>Your application has been submitted successfully. You will receive a confirmation email shortly.</p>
            <div class="ref-box">
                <p>Application Reference Number:</p>
                <p id="refNumber"></p>
            </div>
            <button class="btn-new" onclick="newEnrollment()">Start New Enrollment</button>
        </div>
    </div>

    <script>
        const steps = [
            { title: 'Personal Information', label: 'Personal' },
            { title: 'Academic Details', label: 'Academic' },
            { title: 'Guardian Information', label: 'Guardian' },
            { title: 'Emergency Contact', label: 'Emergency' },
            { title: 'Document Upload', label: 'Documents' },
            { title: 'Review & Submit', label: 'Review' },
        ];

        let currentStep = 0;
        let darkMode = false;
        let uploadedFiles = {};
        let formData = {
            firstName: '', middleName: '', lastName: '', dateOfBirth: '', age: '', sex: '',
            lrn: '', contactNumber: '', address: '', zipCode: '', email: '', gradeLevel: '', strand: '',
            previousSchool: '', schoolYear: '2024-2025', guardianName: '', guardianRelationship: '',
            guardianContact: '', guardianOccupation: '', emergencyContactName: '', 
            emergencyContactRelationship: '', emergencyContactNumber: '',
            birthCertificate: null, form138: null, moralCharacter: null, photo2x2: null,
            residencyProof: null, form137: null,
        };

        function toggleTheme() {
            darkMode = !darkMode;
            document.body.classList.toggle('dark-mode');
            document.getElementById('themeToggle').textContent = darkMode ? '☀️' : '🌙';
        }

        function renderStepper() {
            const stepper = document.getElementById('stepper');
            stepper.innerHTML = steps.map((step, i) => `
                <div class="step">
                    <div class="step-icon ${i === currentStep ? 'active' : ''} ${i < currentStep ? 'completed' : ''}">
                        ${i < currentStep ? '✓' : i + 1}
                    </div>
                    <div class="step-label">${step.label}</div>
                </div>
                ${i < steps.length - 1 ? `<div class="step-connector ${i < currentStep ? 'completed' : ''}"></div>` : ''}
            `).join('');
        }

        function renderForm() {
            const formCard = document.getElementById('formCard');
            let content = '';

            if (currentStep === 0) {
                content = `
                    <h2>Personal Information</h2>
                    <div class="form-grid form-grid-3">
                        <div class="form-group">
                            <label>First Name <span class="required">*</span></label>
                            <input type="text" value="${formData.firstName}" onchange="updateForm('firstName', this.value)" onkeypress="handleEnter(event)" placeholder="Enter first name">
                        </div>
                        <div class="form-group">
                            <label>Middle Name</label>
                            <input type="text" value="${formData.middleName}" onchange="updateForm('middleName', this.value)" onkeypress="handleEnter(event)" placeholder="Enter middle name">
                        </div>
                        <div class="form-group">
                            <label>Last Name <span class="required">*</span></label>
                            <input type="text" value="${formData.lastName}" onchange="updateForm('lastName', this.value)" onkeypress="handleEnter(event)" placeholder="Enter last name">
                        </div>
                    </div>
                    <div class="form-grid form-grid-2">
                        <div class="form-group">
                            <label>Date of Birth <span class="required">*</span></label>
                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 0.5rem;">
                                <select id="dobMonth" onchange="updateDOB()" onkeypress="handleEnter(event)">
                                    <option value="">Month</option>
                                    <option value="01" ${formData.dateOfBirth.substring(5, 7) === '01' ? 'selected' : ''}>January</option>
                                    <option value="02" ${formData.dateOfBirth.substring(5, 7) === '02' ? 'selected' : ''}>February</option>
                                    <option value="03" ${formData.dateOfBirth.substring(5, 7) === '03' ? 'selected' : ''}>March</option>
                                    <option value="04" ${formData.dateOfBirth.substring(5, 7) === '04' ? 'selected' : ''}>April</option>
                                    <option value="05" ${formData.dateOfBirth.substring(5, 7) === '05' ? 'selected' : ''}>May</option>
                                    <option value="06" ${formData.dateOfBirth.substring(5, 7) === '06' ? 'selected' : ''}>June</option>
                                    <option value="07" ${formData.dateOfBirth.substring(5, 7) === '07' ? 'selected' : ''}>July</option>
                                    <option value="08" ${formData.dateOfBirth.substring(5, 7) === '08' ? 'selected' : ''}>August</option>
                                    <option value="09" ${formData.dateOfBirth.substring(5, 7) === '09' ? 'selected' : ''}>September</option>
                                    <option value="10" ${formData.dateOfBirth.substring(5, 7) === '10' ? 'selected' : ''}>October</option>
                                    <option value="11" ${formData.dateOfBirth.substring(5, 7) === '11' ? 'selected' : ''}>November</option>
                                    <option value="12" ${formData.dateOfBirth.substring(5, 7) === '12' ? 'selected' : ''}>December</option>
                                </select>
                                <select id="dobDay" onchange="updateDOB()" onkeypress="handleEnter(event)">
                                    <option value="">Day</option>
                                    ${Array.from({length: 31}, (_, i) => {
                                        const day = String(i + 1).padStart(2, '0');
                                        return `<option value="${day}" ${formData.dateOfBirth.substring(8, 10) === day ? 'selected' : ''}>${day}</option>`;
                                    }).join('')}
                                </select>
                                <select id="dobYear" onchange="updateDOB()" onkeypress="handleEnter(event)">
                                    <option value="">Year</option>
                                    ${Array.from({length: new Date().getFullYear() - 1979}, (_, i) => {
                                        const year = 1980 + i;
                                        return `<option value="${year}" ${formData.dateOfBirth.substring(0, 4) === String(year) ? 'selected' : ''}>${year}</option>`;
                                    }).join('')}
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Age</label>
                            <input type="text" value="${formData.age}" readonly placeholder="Auto-calculated" style="background-color: var(--gray-100); cursor: not-allowed;">
                        </div>
                    </div>
                    <div class="form-grid form-grid-2">
                        <div class="form-group">
                            <label>Sex <span class="required">*</span></label>
                            <select onchange="updateForm('sex', this.value)" onkeypress="handleEnter(event)">
                                <option value="">Select sex</option>
                                <option ${formData.sex === 'Male' ? 'selected' : ''}>Male</option>
                                <option ${formData.sex === 'Female' ? 'selected' : ''}>Female</option>
                                <option ${formData.sex === 'Other' ? 'selected' : ''}>Other</option>
                            </select>
                        </div>
                    <div class="form-grid form-grid-2">
                        <div class="form-group">
                            <label>LRN (Learner Reference Number) <span class="required">*</span></label>
                            <input type="text" value="${formData.lrn}" onchange="updateForm('lrn', this.value)" onkeypress="handleEnter(event)" placeholder="Enter LRN">
                        </div>
                        <div class="form-group">
                            <label>Contact Number <span class="required">*</span></label>
                            <input type="tel" value="${formData.contactNumber}" onchange="updateForm('contactNumber', this.value)" onkeypress="handleEnter(event)" placeholder="Enter contact number">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Email Address <span class="required">*</span></label>
                        <input type="email" value="${formData.email}" onchange="updateForm('email', this.value)" onkeypress="handleEnter(event)" placeholder="Enter email">
                    </div>
                    <div class="form-group">
                        <label>Full Address <span class="required">*</span></label>
                        <input type="text" value="${formData.address}" onchange="updateForm('address', this.value)" onkeypress="handleEnter(event)" placeholder="Enter full address">
                    </div>
                    <div class="form-group">
                        <label>Zip Code <span class="required">*</span></label>
                        <input type="text" value="${formData.zipCode}" onchange="updateForm('zipCode', this.value)" onkeypress="handleEnter(event)" placeholder="Enter zip code">
                    </div>
                `;
            } else if (currentStep === 1) {
                content = `
                    <h2>Academic Details</h2>
                    <div class="form-grid form-grid-2">
                        <div class="form-group">
                            <label>Grade Level <span class="required">*</span></label>
                            <select onchange="updateForm('gradeLevel', this.value)" onkeypress="handleEnter(event)">
                                <option value="">Select grade level</option>
                                <option ${formData.gradeLevel === 'Grade 7' ? 'selected' : ''}>Grade 7</option>
                                <option ${formData.gradeLevel === 'Grade 8' ? 'selected' : ''}>Grade 8</option>
                                <option ${formData.gradeLevel === 'Grade 9' ? 'selected' : ''}>Grade 9</option>
                                <option ${formData.gradeLevel === 'Grade 10' ? 'selected' : ''}>Grade 10</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Strand (SHS)</label>
                            <select onchange="updateForm('strand', this.value)" onkeypress="handleEnter(event)">
                                <option value="">Select strand</option>
                                <option ${formData.strand === 'STEM' ? 'selected' : ''}>STEM</option>
                                <option ${formData.strand === 'ABM' ? 'selected' : ''}>ABM</option>
                                <option ${formData.strand === 'HUMSS' ? 'selected' : ''}>HUMSS</option>
                                <option ${formData.strand === 'GAS' ? 'selected' : ''}>GAS</option>
                                <option ${formData.strand === 'Not Applicable' ? 'selected' : ''}>Not Applicable</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Previous School</label>
                        <input type="text" value="${formData.previousSchool}" onchange="updateForm('previousSchool', this.value)" onkeypress="handleEnter(event)" placeholder="Enter previous school">
                    </div>
                    <div class="info-box">
                        <p><strong>School Year:</strong> ${formData.schoolYear}</p>
                    </div>
                `;
            } else if (currentStep === 2) {
                content = `
                    <h2>Guardian/Parent Information</h2>
                    <div class="form-group">
                        <label>Guardian Full Name <span class="required">*</span></label>
                        <input type="text" value="${formData.guardianName}" onchange="updateForm('guardianName', this.value)" onkeypress="handleEnter(event)" placeholder="Enter guardian name">
                    </div>
                    <div class="form-grid form-grid-2">
                        <div class="form-group">
                            <label>Relationship <span class="required">*</span></label>
                            <select onchange="updateForm('guardianRelationship', this.value)" onkeypress="handleEnter(event)">
                                <option value="">Select relationship</option>
                                <option ${formData.guardianRelationship === 'Father' ? 'selected' : ''}>Father</option>
                                <option ${formData.guardianRelationship === 'Mother' ? 'selected' : ''}>Mother</option>
                                <option ${formData.guardianRelationship === 'Guardian' ? 'selected' : ''}>Guardian</option>
                                <option ${formData.guardianRelationship === 'Other' ? 'selected' : ''}>Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Occupation</label>
                            <input type="text" value="${formData.guardianOccupation}" onchange="updateForm('guardianOccupation', this.value)" onkeypress="handleEnter(event)" placeholder="Enter occupation">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Contact Number <span class="required">*</span></label>
                        <input type="tel" value="${formData.guardianContact}" onchange="updateForm('guardianContact', this.value)" onkeypress="handleEnter(event)" placeholder="Enter contact number">
                    </div>
                `;
            } else if (currentStep === 3) {
                content = `
                    <h2>Emergency Contact Details</h2>
                    <div class="form-group">
                        <label>Emergency Contact Name <span class="required">*</span></label>
                        <input type="text" value="${formData.emergencyContactName}" onchange="updateForm('emergencyContactName', this.value)" onkeypress="handleEnter(event)" placeholder="Enter name">
                    </div>
                    <div class="form-grid form-grid-2">
                        <div class="form-group">
                            <label>Relationship <span class="required">*</span></label>
                            <select onchange="updateForm('emergencyContactRelationship', this.value)" onkeypress="handleEnter(event)">
                                <option value="">Select relationship</option>
                                <option ${formData.emergencyContactRelationship === 'Parent' ? 'selected' : ''}>Parent</option>
                                <option ${formData.emergencyContactRelationship === 'Sibling' ? 'selected' : ''}>Sibling</option>
                                <option ${formData.emergencyContactRelationship === 'Relative' ? 'selected' : ''}>Relative</option>
                                <option ${formData.emergencyContactRelationship === 'Friend' ? 'selected' : ''}>Friend</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Contact Number <span class="required">*</span></label>
                            <input type="tel" value="${formData.emergencyContactNumber}" onchange="updateForm('emergencyContactNumber', this.value)" onkeypress="handleEnter(event)" placeholder="Enter contact number">
                        </div>
                    </div>
                `;
            } else if (currentStep === 4) {
                content = `
                    <h2>Upload Required Documents</h2>
                    <div class="alert alert-warning">
                        <span>⚠️</span>
                        <div>
                            <p><strong>Document Requirements</strong></p>
                            <p>All marked fields are required. Accepted formats: PDF, JPG, PNG, DOC</p>
                        </div>
                    </div>
                    <div class="form-grid form-grid-2">
                        ${renderFileUpload('birthCertificate', 'Birth Certificate (PSA)', true)}
                        ${renderFileUpload('form138', 'Form 138 / Report Card', true)}
                        ${renderFileUpload('moralCharacter', 'Certificate of Good Moral Character', true)}
                        ${renderFileUpload('photo2x2', 'Recent 2x2 Photo', true)}
                        ${renderFileUpload('residencyProof', 'Proof of Residency', true)}
                        ${renderFileUpload('form137', 'Form 137 (for Transferees)', false)}
                    </div>
                `;
            } else if (currentStep === 5) {
                content = `
                    <h2>Review Your Information</h2>
                    <div class="review-section">
                        <h3>Personal Information</h3>
                        <div class="review-grid">
                            <div class="review-item">
                                <p>Full Name</p>
                                <p>${formData.firstName} ${formData.middleName} ${formData.lastName}</p>
                            </div>
                            <div class="review-item">
                                <p>Date of Birth</p>
                                <p>${formData.dateOfBirth || 'Not provided'}</p>
                            </div>
                            <div class="review-item">
                                <p>Age</p>
                                <p>${formData.age || 'Not calculated'}</p>
                            </div>
                            <div class="review-item">
                                <p>Sex</p>
                                <p>${formData.sex}</p>
                            </div>
                            <div class="review-item">
                                <p>LRN</p>
                                <p>${formData.lrn}</p>
                            </div>
                            <div class="review-item">
                                <p>Contact Number</p>
                                <p>${formData.contactNumber}</p>
                            </div>
                            <div class="review-item">
                                <p>Email</p>
                                <p>${formData.email}</p>
                            </div>
                        </div>
                            <div class="review-item">
                                <p>Address</p>
                                <p>${formData.address}</p>
                            </div>
                            <div class="review-item">
                                <p>Zip Code</p>
                                <p>${formData.zipCode}</p>
                            </div>
                    </div>
                    <div class="review-section">
                        <h3>Academic Details</h3>
                        <div class="review-grid">
                            <div class="review-item">
                                <p>Grade Level</p>
                                <p>${formData.gradeLevel}</p>
                            </div>
                            <div class="review-item">
                                <p>Strand</p>
                                <p>${formData.strand || 'N/A'}</p>
                            </div>
                            <div class="review-item">
                                <p>School Year</p>
                                <p>${formData.schoolYear}</p>
                            </div>
                        </div>
                        <div class="review-item">
                            <p>Previous School</p>
                            <p>${formData.previousSchool || 'Not provided'}</p>
                        </div>
                    </div>
                    <div class="review-section">
                        <h3>Guardian Information</h3>
                        <div class="review-grid">
                            <div class="review-item">
                                <p>Guardian Name</p>
                                <p>${formData.guardianName}</p>
                            </div>
                            <div class="review-item">
                                <p>Relationship</p>
                                <p>${formData.guardianRelationship}</p>
                            </div>
                            <div class="review-item">
                                <p>Occupation</p>
                                <p>${formData.guardianOccupation || 'Not provided'}</p>
                            </div>
                        </div>
                        <div class="review-item">
                            <p>Contact Number</p>
                            <p>${formData.guardianContact}</p>
                        </div>
                    </div>
                    <div class="review-section">
                        <h3>Emergency Contact</h3>
                        <div class="review-grid">
                            <div class="review-item">
                                <p>Name</p>
                                <p>${formData.emergencyContactName}</p>
                            </div>
                            <div class="review-item">
                                <p>Relationship</p>
                                <p>${formData.emergencyContactRelationship}</p>
                            </div>
                            <div class="review-item">
                                <p>Contact Number</p>
                                <p>${formData.emergencyContactNumber}</p>
                            </div>
                        </div>
                    </div>
                    <div class="review-section">
                        <h3>Uploaded Documents</h3>
                        <div>
                            ${renderDocumentsList()}
                        </div>
                    </div>
                    <div class="alert alert-success">
                        <span>✓</span>
                        <p>All information has been reviewed. Click Submit to complete your enrollment.</p>
                    </div>
                `;
            }

            formCard.innerHTML = content;
        }

        function renderFileUpload(field, label, required) {
            const isUploaded = uploadedFiles[field];
            return `
                <div class="form-group">
                    <label>${label} ${required ? '<span class="required">*</span>' : ''}</label>
                    <div class="file-upload ${isUploaded ? 'uploaded' : ''}" onclick="document.getElementById('${field}').click()">
                        <div class="file-upload-content">
                            <span class="file-upload-icon">${isUploaded ? '✓' : '📁'}</span>
                            <p class="file-upload-text">${isUploaded ? `✓ ${isUploaded}` : 'Click to upload or drag and drop'}</p>
                            ${!isUploaded ? '<p class="file-upload-hint">PDF, JPG, PNG, DOC (Max 5MB)</p>' : ''}
                        </div>
                        <input type="file" id="${field}" style="display:none;" accept=".pdf,.jpg,.jpeg,.png,.doc,.docx" onchange="handleFileUpload('${field}')">
                    </div>
                </div>
            `;
        }

        function renderDocumentsList() {
            const docs = [
                { key: 'birthCertificate', label: 'Birth Certificate' },
                { key: 'form138', label: 'Form 138' },
                { key: 'moralCharacter', label: 'Good Moral Certificate' },
                { key: 'photo2x2', label: '2x2 Photo' },
                { key: 'residencyProof', label: 'Proof of Residency' },
                { key: 'form137', label: 'Form 137' }
            ];
            return docs.map(doc => `
                <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem; font-size: 0.875rem;">
                    <span style="color: ${uploadedFiles[doc.key] ? '#16a34a' : '#9ca3af'};">${uploadedFiles[doc.key] ? '✓' : '○'}</span>
                    <span>${doc.label}: ${uploadedFiles[doc.key] || 'Not uploaded'}</span>
                </div>
            `).join('');
        }

        function updateForm(field, value) {
            formData[field] = value;
            
            // Auto-calculate age when date of birth is set
            if (field === 'dateOfBirth' && value) {
                const birthDate = new Date(value);
                const today = new Date();
                let age = today.getFullYear() - birthDate.getFullYear();
                const monthDiff = today.getMonth() - birthDate.getMonth();
                
                if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDate.getDate())) {
                    age--;
                }
                
                formData.age = age;
                renderForm();
            }
        }

        function updateDOB() {
            const month = document.getElementById('dobMonth').value;
            const day = document.getElementById('dobDay').value;
            const year = document.getElementById('dobYear').value;
            
            if (month && day && year) {
                const dob = `${year}-${month}-${day}`;
                updateForm('dateOfBirth', dob);
            }
        }

        function handleEnter(event) {
            if (event.key === 'Enter') {
                event.preventDefault();
                const inputs = Array.from(document.querySelectorAll('input, select'));
                const currentIndex = inputs.indexOf(event.target);
                
                if (currentIndex > -1 && currentIndex < inputs.length - 1) {
                    inputs[currentIndex + 1].focus();
                } else if (currentIndex === inputs.length - 1) {
                    handleNext();
                }
            }
        }

        function handleFileUpload(field) {
            const fileInput = document.getElementById(field);
            if (fileInput.files[0]) {
                uploadedFiles[field] = fileInput.files[0].name;
                renderForm();
            }
        }

        function handleNext() {
            if (currentStep < steps.length - 1) {
                currentStep++;
                update();
            } else if (currentStep === steps.length - 1) {
                submit();
            }
        }

        function handlePrevious() {
            if (currentStep > 0) {
                currentStep--;
                update();
            }
        }

        function update() {
            renderStepper();
            renderForm();
            updateButtons();
            updateProgress();
            window.scrollTo(0, 0);
        }

        function updateButtons() {
            document.getElementById('prevBtn').disabled = currentStep === 0;
            const nextBtn = document.getElementById('nextBtn');
            if (currentStep === steps.length - 1) {
                nextBtn.textContent = '✓ Submit Enrollment';
                nextBtn.className = 'btn-submit';
            } else {
                nextBtn.textContent = 'Next →';
                nextBtn.className = 'btn-next';
            }
        }

        function updateProgress() {
            document.getElementById('progressText').textContent = `Step ${currentStep + 1} of ${steps.length}`;
        }

        function submit() {
            const refNumber = `MNHS-2024-${Math.floor(Math.random() * 10000)}`;
            document.getElementById('refNumber').textContent = refNumber;
            document.getElementById('formCard').parentElement.classList.add('hidden');
            document.getElementById('completionScreen').classList.remove('hidden');
            document.getElementById('stepper').classList.add('hidden');
            document.querySelector('.button-group').classList.add('hidden');
            document.getElementById('progressText').classList.add('hidden');
        }

        function newEnrollment() {
            currentStep = 0;
            formData = {
                firstName: '', middleName: '', lastName: '', dateOfBirth: '', sex: '',
                lrn: '', contactNumber: '', address: '', zipCode: '', email: '', gradeLevel: '', strand: '',
                previousSchool: '', schoolYear: '2024-2025', guardianName: '',
                guardianRelationship: '', guardianContact: '', guardianOccupation: '',
                emergencyContactName: '', emergencyContactRelationship: '', emergencyContactNumber: '',
                birthCertificate: null, form138: null, moralCharacter: null, photo2x2: null,
                residencyProof: null, form137: null,
            };
            uploadedFiles = {};
            document.getElementById('completionScreen').classList.add('hidden');
            document.getElementById('formCard').parentElement.classList.remove('hidden');
            document.getElementById('stepper').classList.remove('hidden');
            document.querySelector('.button-group').classList.remove('hidden');
            document.getElementById('progressText').classList.remove('hidden');
            update();
        }

        // Initialize
        update();
    </script>
</body>
</html>